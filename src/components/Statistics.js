import React, { Component } from "react";import { View, Text, Image, TouchableOpacity, Platform, Dimensions, I18nManager, KeyboardAvoidingView } from "react-native";import { Container, Content, Header, Button, Left, Body, Right, Card, Icon} from 'native-base'import styles from '../../assets/styles';import {NavigationEvents} from "react-navigation";import axios from "axios";import CONST from "../consts";import Spinner from "react-native-loading-spinner-overlay";import {connect} from "react-redux";import ProgressBar from '@kcodev/react-native-progress-bar';const rates = [	{ id: 1, name: 'ممتاز' , color: '#26336d'},	{ id: 2, name: 'جيد جدا' , color: '#52c0c5'},	{ id: 3, name: 'جيد' , color: '#f6b145'},	{ id: 4, name: 'مقبول' , color: '#ed4344'},	{ id: 5, name: 'ضعيف' , color: '#000000'},];class Statistics extends Component {	constructor(props){		super(props);		this.state={			spinner     		: false,			statistics  		: [],			notificationCounter	: 0		}	}	componentWillMount() {		this.setState({ spinner  : true });		axios({			url         : CONST.url + 'statistics',			method      : 'POST',			headers     : { Authorization: this.props.user.token },		}).then(response => {			this.setState({ spinner  : false, statistics: response.data.data, notificationCounter: response.data.extra.notifications_count  })		});	}	static navigationOptions = () => ({		header      : null,		drawerLabel : ({ focused }) => ( <Text style={[styles.textRegular, styles.textSize_18, { color: focused ? '#f6b549' : '#27336d' }]}>عن التطبيق</Text> ) ,		drawerIcon  : ({ focused }) => ( <Image style={[styles.smImage]} source={focused ? require('../../assets/images/yellow_info.png') : require('../../assets/images/blue_info.png')} resizeMode={'cover'}/>)	});	onFocus(){		this.componentWillMount()	}	render() {		return (			<Container>				<Spinner visible = { this.state.spinner } />				<NavigationEvents onWillFocus={() => this.onFocus()} />				<Header style={styles.headerView}>					<Right style={{ flex: 0 }}>						<Button transparent onPress={() => this.props.navigation.goBack()}>							<Image source={require('../../assets/images/back.png')} resizeMode={'contain'} style={{ width: 25, height: 25 }}/>						</Button>					</Right>					<Body style={{ width: '100%', alignItems: 'center', alignSelf: 'center' }}>					<Text style={[styles.textBold, styles.text_White, { fontSize: 18, alignSelf: 'center' }]}>الاحصائيات</Text>					</Body>					<Left style={{ flex: 0 }}>						<Image source={require('../../assets/images/vector.png')} resizeMode={'contain'} style={{ width: 100, height: 100, top: 5, right: -5 }}/>					</Left>				</Header>				<Content contentContainerStyle={styles.bgFullWidth}>					<View style={{ padding: 15 }}>						<View style={{ flexDirection: 'row', justifyContent: 'space-around', marginBottom: 10 }}>							<Text style={[styles.textBold, styles.textRight, { color: '#000' }]}>تقييم الطالب</Text>							{								rates.map(( rate, i ) => (									<View key={i}>										<View style={{ width: 20, height: 15, backgroundColor: rate.color, alignSelf: 'center' }} />										<Text style={[ styles.textRegular, { textAlign: 'center', marginTop: 5 }]}>{ rate.name }</Text>									</View>								))							}						</View>						{							this.state.statistics.map((statistic, i) => (								<Card style={{ borderRadius: 10, width: '100%', marginTop: 10, height: 110 }} key={i}>									<View style={{ borderRadius: 10, borderLeftWidth: 5, borderLeftColor: i%2 == 0 ? '#f6b756' : '#303d74', width: '100%', height: 110, flexDirection: 'row', padding: 5 }}>										<View style={{ borderRightWidth: 1, borderRightColor: '#ddd', width: '30%', justifyContent: 'center' }}>											<Text style={[styles.textBold, { color: '#999', textAlign: 'center' }]} >{ statistic.name }</Text>										</View>										<View style={{ padding: 5, width: '70%' }}>											<View style={{ flexDirection: 'row', margin: 5 }}>												<View style={{ width: 20, height: 15, backgroundColor: rates[statistic.rate.key-1].color, alignSelf: 'center',  }} />												<Text style={[ styles.textRegular, { textAlign: 'center', marginHorizontal: 10 }]}>{ statistic.rate.rate }</Text>											</View>											<Text style={[styles.textRegular, styles.textRight, { color: '#999', marginHorizontal: 5 }]}>{ statistic.rate.text }</Text>											<View style={{ flexDirection: "row", flex: 1, marginVertical: 5 }}>												<View style={{ flex: 1, marginTop: 3 }}>													<ProgressBar														value={statistic.progress}														maxValue={100}														backgroundColorOnComplete="#dedede"														backgroundColor={rates[statistic.rate.key-1].color}														height={10}													/>												</View>												<View>													<Icon name={'checkcircle'} type={'AntDesign'} style={{ fontSize: 15, color: '#f6b346', marginHorizontal: 5 }}/>												</View>											</View>										</View>									</View>								</Card>							))						}					</View>				</Content>				<Card style={{ position: 'absolute', width: '80%', bottom: 20, height: 50, borderRadius: 20, alignSelf: 'center', alignItems: 'center', justifyContent: 'space-around', flexDirection: 'row', padding: 10 }}>					<TouchableOpacity onPress={() => this.props.navigation.navigate('drawerNavigator')}>						<Image source={require('../../assets/images/gray_home.png')} resizeMode={'contain'} style={{ width: 30, height: 30 }}/>					</TouchableOpacity>					<TouchableOpacity onPress={() => this.props.navigation.navigate('statistics')}>						<Image source={require('../../assets/images/yellow_statistic.png')} resizeMode={'contain'} style={{ width: 30, height: 30 }}/>					</TouchableOpacity>					<TouchableOpacity onPress={() => this.props.navigation.navigate('notification')}>						<Image source={require('../../assets/images/bell.png')} resizeMode={'contain'} style={{ width: 30, height: 30 }}/>						<View style={{ position: 'absolute', borderRadius: 30, backgroundColor: '#f00', width:20, height: 20}}>							<Text style={{ color: '#fff', textAlign: 'center' }}>{ this.state.notificationCounter }</Text>						</View>					</TouchableOpacity>					<TouchableOpacity onPress={() => this.props.navigation.navigate('profile')} style={{ borderRadius: 50, borderWidth: 2, borderColor: '#27336d', overflow: 'hidden' }}>						<Image source={{ uri: this.props.user.avatar }} resizeMode={'contain'} style={{ width: 35, height: 35, borderRadius: 50}}/>					</TouchableOpacity>				</Card>			</Container>		);	}}const mapStateToProps = ({ auth, profile }) => {	return {		auth    : auth.user,		user    : profile.user	};};export default connect(mapStateToProps, {  })(Statistics);